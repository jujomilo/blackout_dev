# âœ… SecciÃ³n 1.2 â€“ Redes, Puertos y Servicios
Bienvenido a la SecciÃ³n 1.2 del curso de Pentesting de Videojuegos. AquÃ­ seguimos construyendo sobre lo que ya aprendiste en la 1.1.
**Objetivo**: Comprender cÃ³mo los videojuegos utilizan redes, puertos y servicios, y quÃ© oportunidades abre esto para la auditorÃ­a Ã©tica.

## ğŸ”¹ 1. Â¿QuÃ© es un puerto y por quÃ© importa?

 ğŸ“˜ DefiniciÃ³n breve:

Un puerto es un nÃºmero lÃ³gico que identifica un servicio especÃ­fico en una mÃ¡quina con IP. Cuando un juego se conecta a un servidor, lo hace a travÃ©s de un puerto.

### ğŸ•¹ Ejemplo en videojuegos:

Un juego multijugador podrÃ­a usar el puerto 27015 (muy usado por juegos de Valve como Counter-Strike).

Si ese puerto estÃ¡ abierto, un atacante podrÃ­a intentar interactuar con Ã©l.

### ğŸ¯ Conceptos clave:

Puerto abierto: el servicio estÃ¡ accesible.

Puerto cerrado: no hay servicio escuchando.

Puerto filtrado: hay un firewall o filtro bloqueando.

## ğŸ”¹ 2. Â¿QuÃ© es un servicio y cÃ³mo se relaciona?

 ğŸ“˜ Servicio = Software que escucha en un puerto.
Ejemplos:

HTTP (web) escucha en el 80

SSH escucha en el 22

En juegos: un servicio propio del servidor que gestiona jugadores, partidas, etc.

ğŸ’¡ Algunos servicios de juegos pueden tener fallos.

## ğŸ”¹ 3. Herramientas iniciales de escaneo

### ğŸ›  Nmap (el clÃ¡sico):
```
nmap -sS -p- IP_DEL_SERVIDOR
```
![captura bash](./capturas/4.png)

ğŸ” Â¿QuÃ© resultados devuelve?

Nmap mostrarÃ¡ una lista de puertos TCP con su estado:
![captura bash](./capturas/5.png)

ğŸ¯ Â¿CuÃ¡ndo usarlo?
Este comando es ideal cuando:

No sabes en quÃ© puertos escucha un servidor (por ejemplo, un juego personalizado).

Quieres un escaneo completo y no perderte servicios ocultos.

EstÃ¡s en una auditorÃ­a inicial.


antes de continuar, vamos a establecer un flujo de trabajo base, para realizar nuestras auditorÃ­as, es muy importante tener todo bien organizado y accesible, para ello definiremos el siguiente workflow:

# ğŸ—‚ï¸ FLUJO DE TRABAJO ORGANIZADO PARA PENTESTING

(Inspirado en buenas prÃ¡cticas reales)

### ğŸ“ 1. Estructura base de carpetas
Creamos una carpeta por objetivo (por ejemplo, objetivo_minecraft_server), y dentro de ella, subcarpetas temÃ¡ticas para cada fase del anÃ¡lisis:

```
objetivo_minecraft_server/
â”œâ”€â”€ 01_reconocimiento/
â”‚   â”œâ”€â”€ escaneo_puertos.txt
â”‚   â”œâ”€â”€ escaneo_udp.txt
â”‚   â”œâ”€â”€ puertos_abiertos.txt
â”‚   â””â”€â”€ servicios_detectados.txt
â”œâ”€â”€ 02_enum/
â”‚   â”œâ”€â”€ banners.txt
â”‚   â””â”€â”€ versiones_soft.txt
â”œâ”€â”€ 03_explotacion/
â”‚   â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ credenciales.txt
â”œâ”€â”€ 04_sniffing/
â”‚   â””â”€â”€ capturas.pcap
â”œâ”€â”€ 05_notas/
â”‚   â””â”€â”€ resumen.md
```

### ğŸ“ Â¿QuÃ© guarda cada carpeta?

```
| Carpeta                Contenido                                                                   
----------------------------------------------------------------------------- |
| 01_reconocimiento/   | Escaneos con Nmap (puertos, servicios), filtrado con grep.                  


| 02_enum/             | EnumeraciÃ³n activa de versiones, banners y posibles 
vulnerabilidades.      


| 03_explotacion/      | Scripts de explotaciÃ³n, contraseÃ±as encontradas, notas de prueba.   


| 04_sniffing/         | Archivos `.pcap` de capturas de red, anotaciones asociadas.   


| 05_notas/            | Markdown con todo lo aprendido, Ãºtil como documentaciÃ³n final del anÃ¡lisis. 
```
## ğŸ”§ Comando inicial para preparar entorno
Puedes tener un script base de preparaciÃ³n, o hacerlo a mano al inicio de cada anÃ¡lisis, de momento aprenderemos a crear nuestro entorno de trabajo a mano y mÃ¡s adelante lo automatizaremos mediante un script de Python.
para crear nuestra estructura de carpeta ejecutaremos el siguiente comando:

```
mkdir -p objetivo_minecraft_server/{01_reconocimiento,02_enum,03_explotacion,04_sniffing,05_notas}
cd objetivo_minecraft_server/01_reconocimiento

```
Â¿QuÃ© hace?
Crea una carpeta llamada objetivo_minecraft_server y dentro de ella varias subcarpetas a la vez.

Partes del comando:
![captura bash](./capturas/6.png)


Y ya estÃ¡s listo para comenzar el primer escaneo, cuando lancemos nuestro nmap, que podemos llamar por ejemplo; escaneo_puertos.txt este archivo se guardarÃ¡ en la carpeta donde nos encontremos, por ello antes delanzarlo, nos situraremos enla carpeta donde queremos guardarlo en este caso , en la carpeta 01_reconocimiento:

```
cd objetivo_minecraft_server/01_reconocimiento
```

```
nmap -sS -p- -T4 -v -oN escaneo_puertos.txt 127.0.0.1
```
ğŸ“Œ Consejo extra: Para asegurarte siempre de estar en la carpeta correcta antes de lanzar un escaneo:

```
pwd
```
Con Pwd se nos indica donde nos encontramos dentro del sistema.

# ğŸ§ª EJERCICIO BASE â€“ ESTRUCTURA DE ATAQUE + PRIMER ESCANEO

### ğŸ¯ Objetivo: 

- Crear la estructura base de trabajo.

- Hacer un escaneo de puertos contra un objetivo real y autorizado.

- Guardar los resultados correctamente.

## ğŸ”§ PASO A PASO

### âœ… PASO 1 â€“ Crear la estructura de carpetas
lo primero serÃ¡ situarnos en nuestra carpeta de usaurio normal dentro del sistema Kali. nuestra carpeta de usuario es:
```
/home/tu_usuario/
```
Pero se accede de forma mÃ¡s directa usando el sÃ­mbolo:
```
cd ~
```
O simplemente:
```
cd
```
Entonces primero la carpeta pentesting:
```
cd ~               # Ir a tu carpeta de usuario
mkdir pentesting   # Crear la carpeta base de trabajo
cd pentesting      # Entrar en ella
```
Una vez dentro de ella queremos consturir la siguiente estructura:

```
~/pentesting/scanme_nmap_org/
â”œâ”€â”€ 01_reconocimiento/
â”œâ”€â”€ 02_enum/
â”œâ”€â”€ 03_explotacion/
â”œâ”€â”€ 04_sniffing/
â””â”€â”€ 05_notas/
```

Podemos crear estas carpetas de forma nanual dela siguiente manera:
```
## ğŸ¥ Ejercicio 2 â€“ Estructura de trabajo Pentesting en Kali Linux

En este ejercicio se muestra cÃ³mo crear la estructura de carpetas base que utilizaremos en todos los anÃ¡lisis del curso.  
Se enseÃ±a tanto la creaciÃ³n manual (paso a paso) como la versiÃ³n optimizada en una sola lÃ­nea.

ğŸ”— **VÃ­deo complementario:**  
[Estructura de trabajo Pentesting Kali Linux bÃ¡sica](https://youtu.be/pW5RC3Lj0B8)
Este vÃ­deo forma parte de la documentaciÃ³n visual del curso y estÃ¡ vinculado al contenido del MÃ³dulo 0 y la preparaciÃ³n previa al uso de herramientas como Nmap.

---

### âœ… OpciÃ³n 1 â€“ CreaciÃ³n manual (paso a paso)

```bash
cd ~
mkdir pentesting
cd pentesting
mkdir scanme_nmap_org
cd scanme_nmap_org
mkdir 01_reconocimiento
mkdir 02_enum
mkdir 03_explotacion
mkdir 04_sniffing
mkdir 05_notas

```
```

---

### âœ… OpciÃ³n 2 â€“ CreaciÃ³n automatizada (una sola lÃ­nea)

mkdir -p ~/pentesting/scanme_nmap_org/{01_reconocimiento,02_enum,03_explotacion,04_sniffing,05_notas}
cd ~/pentesting/scanme_nmap_org/01_reconocimiento


```

### âœ… PASO 2 â€“ Lanzar el escaneo de puertos

```
nmap -sS -p- -T4 -v -oN escaneo_puertos.txt scanme.nmap.org
```
ğŸ“ Resultado: el archivo escaneo_puertos.txt se guarda en 01_reconocimiento/.
recuerda:

- ***nmap***: Es la **herramienta de escaneo de red** descubre **puertos** y - **servicios** en una red o en la IP que vamos a escanear.

- ***-sS***: **TCP SYN Scan**. EnvÃ­a un pquete SYN(inicio de conexiÃ³n) a cada puerto. Si el puerto responde con SYN_ACK, estÃ¡ abierto. Si responde con RST, estÃ¡ cerrado. No finaliza la conexiÃ³n, lo que lo hace rÃ¡pido y sigiloso.

- ***-p-***: Escanea todos los puertos TCP, del 1 al 65535. Por defecto, Nmap escanea solo 1000 puertos comunes. Con -p- escaneamos todos, para no perder ningÃºn servicio que pueda estar activo en puertos inusuales (muy frecuente en servidores de videojuegos).

- ***IP_DEL_SERVICIO***: DirecciÃ³n IP del objetivo. Puede ser una IP local (127.0.0.1), una IP privada (192.168.1.1) o una IP pÃºblica de un servidor.

### âœ… PASO 3 â€“ Filtrar puertos abiertos

```
grep "open" escaneo_puertos.txt > puertos_abiertos.txt
```
grep "open" escaneo_puertos.txt > puertos_abiertos.txt  este filtrado de la cadena open con grep, lo harÃ­amos dentro de la carpeta donde hemos guardado el escaneo ***01_reconocimiento*** y crearÃ­a, mediante el operador > un nuevo archivo en esa misma capeta  con los puertos encontrados conla cadena "open".
Esto te deja una lista limpia con los puertos abiertos, Ãºtil para la enumeraciÃ³n futura (fase 02_enum).

### âœ… PASO 4 â€“ Verifica dÃ³nde estÃ¡s y quÃ© tienes
```
pwd
ls -l
```
AsegÃºrate de estar en el directorio correcto y ver los archivos generados.

### ğŸ“ Estructura resultante esperada:
```
scanme_nmap_org/
â”œâ”€â”€ 01_reconocimiento/
â”‚   â”œâ”€â”€ escaneo_puertos.txt
â”‚   â””â”€â”€ puertos_abiertos.txt
â”œâ”€â”€ 02_enum/
â”œâ”€â”€ 03_explotacion/
â”œâ”€â”€ 04_sniffing/
â”œâ”€â”€ 05_notas/
```

Como el escaneo de 65535 se puede demorar bastante, vamos a hacer un primer Escaneo rÃ¡pido de puertos reduciendo el rango de puertos a escanear.

# ğŸ§ª Ejercicio 3 (versiÃ³n reducida) â€“ Escaneo rÃ¡pido de puertos con Nmap

### ğŸ¯ Objetivo:

- Realizar un escaneo rÃ¡pido y prÃ¡ctico contra un servidor real.

- Detectar puertos abiertos en el rango 1â€“1024.

- Guardar los resultados de forma ordenada en nuestra estructura de trabajo.

### âœ… PASO 1 â€“ Acceder a la carpeta de trabajo
```
cd ~/pentesting/scanme_nmap_org/01_reconocimiento
```

### âœ… PASO 2 â€“ Lanzar el escaneo de puertos comunes
```
nmap -sS -p 1-1024 -T4 -v -oN escaneo_puertos.txt scanme.nmap.org
```
repasemos el comando una vez mÃ¡s:
- -sS = Escaneo SYN (rÃ¡pido y sigiloso)
- -p 1-1024 = Escanea solo los puertos comunues (mÃ¡s usados)
- -T4 = Escaneo rÃ¡pido pero sin ser agresivo
- -v = Muerstra el progreso en pantalla (verbose)
- oN escaneo_puertos.txt = Guarda salida en formato legible en archivo.

## ğŸ“Œ Â¿QuÃ© es -oN en Nmap?
Es una opciÃ³n propia de Nmap que le indica que guarde el resultado del escaneo en un archivo, con formato â€œnormalâ€ (legible para humanos).
```
-oN escaneo_puertos.txt
```
### ğŸ¤” Â¿Y por quÃ© no usamos simplemente > como en grep?
Porque Nmap no imprime el resultado completo solo por consola, lo gestiona internamente y tiene varios formatos de salida que puedes elegir:

![captura bash](./capturas/7.png)

Usar -oN es la forma oficial y controlada de exportar resultados con Nmap.
El operador > estÃ¡ bien para comandos como grep, cat, echo, etc., pero no sustituye los mecanismos de salida especÃ­ficos de herramientas como Nmap.



### âœ… PASO 3 â€“ Verificar el contenido
Una vez terminado, puedes ver el resultado con:
```
cat escaneo_puertos.txt
```
ğŸ“Œ DeberÃ­as ver algo como:
```
22/tcp open ssh
80/tcp open http
```
### âœ… PASO 4 â€“ Filtrar puertos abiertos
```
grep "open" escaneo_puertos.txt > puertos_abiertos.txt
```
Este comando extrae solo las lÃ­neas que contienen puertos abiertos y crea un archivo limpio llamado puertos_abiertos.txt.
### âœ… PASO 5 â€“ Comprobar archivos generados
```
ls -l
```

```
-rw-r--r-- 1 usuario usuario  ... escaneo_puertos.txt
-rw-r--r-- 1 usuario usuario  ... puertos_abiertos.txt
```


En este ejercicio realizamos un escaneo de puertos comunes usando Nmap desde Kali Linux.  
El resultado se guarda en la carpeta `01_reconocimiento/` y se filtran los puertos abiertos para su posterior anÃ¡lisis en la fase de enumeraciÃ³n.

ğŸ”— **VÃ­deo complementario (sin voz, uso documental):**  
[3 Escaneo de puertos con Nmap â€“ Curso bÃ¡sico de Pentesting (MÃ³dulo 1)](https://youtu.be/HEPqUwvkyYHe2UxEoAVNsi)

ğŸ“ Archivos generados en el ejercicio:
- `escaneo_puertos.txt`: Resultado completo del escaneo
- `puertos_abiertos.txt`: Resultado filtrado con `grep "open"`

